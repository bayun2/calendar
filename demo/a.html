HTML>
<HEAD>
  <meta charset="utf-8">
<TITLE>日历</TITLE>
</HEAD>
<BODY>
当前日期：<div id="time"></div>
<hr/>
下周：<br/><div id="week"></div>
<input type="button" value="Last Week" onclick="last_Week('week')"/>
<input type="button" value="Next Week" onclick="next_Week('week')"/>
<div id="info"></div>
<div id="infos"></div>
<script type="text/javascript ">
var time = new Date();
//var t3 = time.getMinutes();//分
//var t4 = time.getHours();//小时
var y = time.getFullYear();//年
var m = time.getMonth()+1;//月 从0开始计算
var d = time.getDate();//日
var w = time.getDay();//周几
document.getElementById("time").innerHTML = y+"年"+m+"月"+d+"日周"+w;
var days ,this_month_days;//当前月份的天数
//1、3、5、7、8、10、12
//4、6、9、11
var weeks = new Array();
//"周一","周二","周三","周四","周五","周六","周日"
weeks[1] = "周一";
weeks[2] = "周二";
weeks[3] = "周三";
weeks[4] = "周四";
weeks[5] = "周五";
weeks[6] = "周六";
weeks[0] = "周日";
var week_day = 1,space = Math.abs(d%7-w-1),last_day,last_week;
document.getElementById("week").innerHTML = get_week(d,w);
//获取往后七天的日期,传入几号和周几两个参数
function  get_week(d,w)
{
   var this_week,this_day;
   this_month_days = get_days(y,m);//取得这个月有多少天
   var html = "";
   html +="<table border='1'/>";
   html +="<tr>";
   // html +="<tr><td>周日</td><td>周一</td><td>周二</td><td>周三</td><td>周四</td><td>周五</td><td>周六</td></tr>";
   for(var i=0;i<7;i++)
   {
       this_week = (w+i >=7?w+i-7:w+i);
       //this_day = d+i <= this_month_days?d+i:d+i-this_month_days;
       if(d+i <= this_month_days)//判断是否已经到了下个月
       {
          this_day=d+i;
       }else
       {
          this_day=d+i-this_month_days;
       }
       html +="<td>"+weeks[this_week]+this_day+"号</td>";
   }
   html +="</tr>";
   html +="</table>";
   //下一周开始时的日期和星期
   //last_week = (this_week >=6?this_week-6:this_week+1);
   last_day =  this_day-6 > 0?this_day-6:this_month_days+this_day-6;
   document.getElementById("info").innerHTML =y+"年"+m+"月"+last_day+"日";
   return html;
}
//获取m月份有的天数,传入年份和月份两个参数
function get_days(y,m)
{
   if((m ==1)||(m ==3)||(m ==5)||(m ==7)||(m ==8)||(m ==10)||(m ==12))
  {
      return 31;
  }else if((m ==4)||(m ==6)||(m ==9)||(m ==11))
  {
     return 30;
  }else
  {
    if(y%4 == 0)
    {
       return 29;
    }else
    {
       return 28;
    }
  }
}
//显示月历
function show_month()
{
     document.write('<table>');
     document.write("<tr><td>周日</td><td>周一</td><td>周二</td><td>周三</td><td>周四</td><td>周五</td><td>周六</td></tr>");
     for(var i=1;i<=days;i++)
     {
      if(week_day %7 == 0)
      {
          document.write("<tr>");
      }
      if(i == 1)
      {
         for(var j=0;j<space;j++)
         {
            document.write("<td></td>");
               week_day++;
         }
      }else{
        week_day++;
      }
      if(i != d)
      {
         document.write("<td>"+i+"</td>");
      }else
      {
         document.write("<td style='background:yellow'>"+i+"</td>");
      }
      if(week_day%7 == 0)
      {
         document.write("</tr>");
            week_day = 0;
   }
  }
  document.write("</table>");
}
//下一周，传入一个参数，写入html的标签的id
function next_Week(id)
{
       if(last_day+7>this_month_days)
       {
          m++;//到下一个月
          if(m>12){
             y++;//下一年
             m=1
          }
       }
   days = get_days(y,m);
   //alert(last_day+7>this_month_days?last_day+7-this_moneth_days:last_day+7);
   document.getElementById(id).innerHTML = get_week(last_day+7>this_month_days?last_day+7-this_month_days:last_day+7,w);
}
//上一周 ，传入一个参数，写入html的标签的id,要获取当前这一天往后前7天的日期和周几
function last_Week(id)
{
  if(last_day-7<1)
       {
          m--; //到下一个月
          if(m<1){
             y--; // 下一年
             m = 12;
          }
       }
   days = get_days(y,m);
   document.getElementById(id).innerHTML = get_week(last_day-7<1?last_day-7+days:last_day-7,w); //get_week(last_day-7>this_month_days?last_day-7-this_month_days:last_day+7,w);
}
</script>
</BODY>
</HTML>
